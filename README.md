# Jalali Shamsi Datepicker for Frappe/ERPNext

یک اپلیکیشن کوچک برای **ERPNext/Frappe** که به شما امکان می‌دهد تاریخ‌ها را به **تقویم شمسی (Jalali/Persian)** مشاهده و وارد کنید، بدون اینکه عملکرد تاریخ‌های میلادی استاندارد سیستم مختل شود.  

این اپلیکیشن مخصوص کسانی است که در ایران کار می‌کنند و می‌خواهند فرم‌ها و گزارش‌ها به تاریخ شمسی نمایش داده شوند، اما داده‌ها به صورت استاندارد (میلادی) در دیتابیس ذخیره شوند.

---

## ویژگی‌ها

- نمایش **تقویم شمسی (Jalali)** در فرم‌های ERPNext برای فیلدهای `Date` و `Datetime`.  
- پشتیبانی از انتخاب تاریخ و زمان با قابلیت **autoClose** و **format سفارشی**.  
- تبدیل خودکار اعداد فارسی به لاتین هنگام ذخیره.  
- نمایش همزمان **تاریخ میلادی معادل** در کنار فیلد برای اطمینان از مقدار واقعی ذخیره شده.  
- امکان فعال یا غیرفعال کردن تقویم شمسی از طریق **System Settings**.  
- بدون تغییر عملکرد پیش‌فرض ERPNext: تقویم میلادی استاندارد همیشه در دسترس است.  
- سبک و بدون وابستگی‌های اضافه، تنها با استفاده از **persian-date.js** و **persian-datepicker.js**.

---

## نصب

1. این ریپازیتوری را به پروژه Frappe/ERPNext خود اضافه کنید:

```bash
bench get-app https://github.com/Atshan/jalali_shamsi_datepicker
bench --site [نام سایت شما] install-app jalali_shamsi_datepicker
````

2. سرویس‌های Bench را ری‌استارت کنید:

```bash
bench build --app jalali_shamsi_datepicker
bench migrate
bench --site [نام سایت شما] migrate
bench clear-cache
bench restart
bench start
```

3. در **System Settings** گزینه‌ی `Enable Shamsi/Jalali Calendar` را فعال کنید و فرمت ذخیره‌سازی را روی `Persian (شمسی)` بگذارید.

4. در پایین همین تنظیمات، فرمت نمایش تاریخ را طبق فرمت تاریخ شمسی روی yyyy/mm/ddd بگذارید.

---

## استفاده

* بعد از فعال‌سازی، تمامی فیلدهای تاریخ و زمان در فرم‌ها به **تقویم شمسی** مجهز می‌شوند.
* با کلیک روی فیلد، تقویم باز می‌شود و تاریخ انتخابی شما به صورت شمسی نمایش داده می‌شود.
* معادل میلادی تاریخ انتخابی همیشه زیر فیلد نمایش داده می‌شود.

---

## فایل‌های کلیدی

* `base.js`
  بررسی می‌کند که آیا شمسی فعال است یا خیر و در صورت فعال بودن، فایل‌های JS مربوط به تقویم را بارگذاری می‌کند.

* `topersian_date.js`
  منطق اصلی برای اتصال Persian Datepicker به فرم‌ها و همزمان نمایش تاریخ میلادی.

* `togregorian_date.js`
  تبدیل تاریخ شمسی انتخاب‌شده به میلادی برای ذخیره در دیتابیس ERPNext.

* `in_words_cleanup.js`
  (در صورت استفاده) برای پاکسازی نمایش حروفی اعداد یا اصلاح فرمت‌های متنی.

---

## نکات مهم

* برای اعمال تغییرات و فعال شدن کامل تقویم شمسی، ممکن است نیاز باشد فرم‌ها یا صفحه را **رفرش کنید**.
* این اپلیکیشن تاریخ‌ها را **به صورت شمسی نمایش** می‌دهد، اما **همچنان داده‌ها در دیتابیس میلادی ذخیره** می‌شوند.
* با این روش، ERPNext به صورت بومی همچنان از داده‌های میلادی استفاده می‌کند و قابلیت گزارش‌گیری یا محاسبات بدون مشکل باقی می‌ماند.

---

## پشتیبانی

* باگ‌ها و مشکلات را در بخش **Issues** این ریپازیتوری ثبت کنید.
* پیشنهادات و ایده‌های جدید برای ارتقاء اپلیکیشن را هم استقبال می کنیم.

---

## مجوز

این پروژه تحت **MIT License** منتشر شده است.

`
```
